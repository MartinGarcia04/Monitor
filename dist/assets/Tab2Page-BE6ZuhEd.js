import{r as $,M as x,N as B,A as O,c as p,w as t,u as a,o as i,b as n,B as N,C as S,D as V,h as A,I as L,O as T,F as d,J as v,K as _,k as P,e as g,g as C,d as m,t as f,j as R,f as I,P as F,Q as M,R as U,n as j,S as H}from"./index-CcQcy7fF.js";import{c as J,d as K,t as Q}from"./index-D1d86mja.js";import{g as h,r as k,o as q,a as z}from"./index.esm2017-DCJN5aiX.js";const G={key:0},ae={__name:"Tab2Page",setup(W){const c=$([]),u=x({}),w=B(()=>{const e={};return c.value.forEach(o=>{const s=o.usuario||"Sin usuario";e[s]||(e[s]={claves:[]},u[s]=!1),e[s].claves.push({id:o.id,timestamp:o.timestamp||Date.now()})}),e}),D=e=>{u[e]=!u[e]},b=e=>new Date(e).toLocaleString(),y=async(e,o)=>{await(await H.create({header:"Confirmar eliminación",message:"¿Eliminar la clave ".concat(e," de ").concat(o,"?"),buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:()=>E(e)}]})).present()},E=e=>{const o=h(),s=k(o,"claves/".concat(e));z(s).then(()=>{console.log("Clave ".concat(e," eliminada")),c.value=c.value.filter(l=>l.id!==e)}).catch(l=>{console.error("Error al eliminar:",l)})};return O(()=>{const e=h(),o=k(e,"claves/");q(o,s=>{const l=[];s.forEach(r=>{l.push({id:r.key,usuario:r.val().usuario||"",timestamp:r.val().timestamp||Date.now()})}),c.value=l})}),(e,o)=>(i(),p(a(j),null,{default:t(()=>[n(a(N),null,{default:t(()=>[n(a(S),null,{default:t(()=>[n(a(V),null,{default:t(()=>o[0]||(o[0]=[A("Administración de Claves")])),_:1})]),_:1})]),_:1}),n(a(L),{fullscreen:!0},{default:t(()=>[n(a(T),null,{default:t(()=>[(i(!0),d(v,null,_(w.value,(s,l)=>(i(),d("div",{key:l},[n(a(g),null,{default:t(()=>[n(a(C),null,{default:t(()=>[m("h2",null,f(l||"Usuario no definido"),1),m("p",null,f(s.claves.length)+" claves",1)]),_:2},1024),n(a(R),{slot:"end",fill:"clear",onClick:r=>D(l)},{default:t(()=>[n(a(I),{icon:u[l]?a(J):a(K)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024),u[l]?(i(),d("div",G,[(i(!0),d(v,null,_(s.claves,r=>(i(),p(a(F),{key:r.id},{default:t(()=>[n(a(g),null,{default:t(()=>[n(a(C),null,{default:t(()=>[m("p",null,"ID: "+f(r.id),1),m("p",null,"Creado: "+f(b(r.timestamp)),1)]),_:2},1024)]),_:2},1024),n(a(M),{side:"end"},{default:t(()=>[n(a(U),{color:"danger",onClick:X=>y(r.id,l)},{default:t(()=>[n(a(I),{slot:"icon-only",icon:a(Q)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))])):P("",!0)]))),128))]),_:1})]),_:1})]),_:1}))}};export{ae as default};
